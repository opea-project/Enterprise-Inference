# Copyright (C) 2024-2025 Intel Corporation
# SPDX-License-Identifier: Apache-2.0

# Values for KServe vLLM on Intel Gaudi AI Accelerators

image:
  repository: vault.habana.ai/gaudi-docker/1.18.0/ubuntu22.04/habanalabs/pytorch-installer-2.5.1
  tag: "latest"
  pullPolicy: IfNotPresent

# Gaudi-specific configurations
accelDevice: "habana.ai/gaudi"
accelDeviceCount: 1

# vLLM Gaudi optimizations
dtype: "bfloat16"
tensor_parallel_size: 1
max_model_len: 8192
gpu_memory_utilization: 0.95

# Resource allocation for Gaudi
resources:
  limits:
    habana.ai/gaudi: 1
    cpu: "32"
    memory: 256Gi
    hugepages-2Mi: "20480Mi"
  requests:
    habana.ai/gaudi: 1
    cpu: "16"
    memory: 128Gi
    hugepages-2Mi: "20480Mi"

# Runtime class for Gaudi
runtimeClassName: habana

# Node selector for Gaudi nodes
nodeSelector:
  node.kubernetes.io/instance-type: gaudi

# Tolerations for Gaudi nodes
tolerations:
  - key: "habana.ai/gaudi"
    operator: "Exists"
    effect: "NoSchedule"

# Model configurations optimized for Gaudi
defaultModelConfigs:
  tensor_parallel_size: 1
  pipeline_parallel_size: 1
  extraCmdArgs:
    - "--disable-log-requests"
    - "--enable-prefix-caching"
    - "--max-num-seqs"
    - "512"
    - "--max-num-batched-tokens"
    - "8192"
    - "--enforce-eager"

# Security context for Gaudi
securityContext:
  capabilities:
    drop:
      - ALL
    add:
      - SYS_NICE
      - SYS_PTRACE
      - IPC_LOCK
  allowPrivilegeEscalation: false
